%%子程序1
function dX=Lorenz_LE(t,X)
global km
k3=2;k4=1;k5=0.05;k6=1.5;I1=0.2;
k7= 1;   k8= 1;     k=1;
x1=X(1);y1=X(2);x2=X(3);y2=X(4);
g1=X(5);g2=X(6);q=X(7);p=X(8); phi=X(9);
Y=[ X(10), X(19), X(28), X(37), X(46), X(55), X(64), X(73), X(82);
    X(11), X(20), X(29), X(38), X(47), X(56), X(65), X(74), X(83);
    X(12), X(21), X(30), X(39), X(48), X(57), X(66), X(75), X(84);
    X(13), X(22), X(31), X(40), X(49), X(58), X(67), X(76), X(85);
    X(14), X(23), X(32), X(41), X(50), X(59), X(68), X(77), X(86);
    X(15), X(24), X(33), X(42), X(51), X(60), X(69), X(78), X(87);
    X(16), X(25), X(34), X(43), X(52), X(61), X(70), X(79), X(88);
    X(17), X(26), X(35), X(44), X(53), X(62), X(71), X(80), X(89);
    X(18), X(27), X(36), X(45), X(54), X(63), X(72), X(81), X(90);
    ];
dX=zeros(81,1);         %创建零矩阵
T1=1/(1+exp(-50*x1+10));
T2=1/(1+exp(-50*x2+10));
Z=2*T1+2*T2;

dX(1)=y1-x1^3+3*x1^2+I1+k*(x2-x1)*g1-k7*p+km*phi*x1;
dX(2)=1-5*x1^2-y1;
dX(3)=x2-(x2^3)/3-y2+k*(x1-x2)*g2+k8*p;
dX(4)=0.1*(x2+0.6-0.1*y2);
dX(5)=0.1*T2*(1-g1)-0.05*g1;
dX(6)=0.1*T1*(1-g2)-0.05*g2;
dX(7)=(1+tanh(Z-2))*(1-q)-k3*q;
dX(8)=-k4*p+k5+k6*q;
dX(9)=-phi+0.5*x1;

% Jaco=[ -3*x1^2+6*x1-k*g1+km*phi, 1, k*g1, 0,  k*(x2-x1),  0,  0, -k7, km*x1;
%     -10*x1, -1, 0, 0, 0, 0, 0, 0, 0;
%     k*g2,  0,  1-x2^2-k*g2, -1,  0,  k*(x1-x2),  0,  k8, 0;
%     0, 0, 0.1, -0.01, 0, 0, 0, 0, 0;
%     0, 0, ((5*exp(10-50*x2))/(exp(10-50*x2)+1)^2)*(1-g1), 0, -0.1*T2-0.05,  0,  0,  0, 0;
%     ((5*exp(10-50*x1))/(exp(10-50*x1)+1)^2)*(1-g2), 0, 0, 0, 0,  -0.1*T1-0.05,  0,  0, 0;
%     (1-q)*(-(100*exp(10-50*x1)*(tanh(2/(exp(10-50*x1)+1)+2/(exp(10-50*x2)+1)-2)^2-1))/(exp(10-50*x1)+1)^2),  0,  (1-q)*(-(100*exp(10-50*x2)*(tanh(2/(exp(10-50*x1)+1)+2/(exp(10-50*x2)+1)-2)^2-1))/(exp(10-50*x2)+1)^2), 0, 0, 0, -(1+tanh(Z-2))-k3, 0, 0;
%     0, 0, 0, 0, 0, 0, k6, -k4, 0;
%     0.5, 0, 0, 0, 0, 0, 0, 0, -1;
%     ];

Jaco=[-3*x1^2+6*x1-g1*k+km*phi, 1, g1*k, 0, -k*(x1 - x2), 0, 0, -k7, km*x1;
       -10*x1, -1, 0, 0, 0, 0, 0, 0, 0;
       g2*k, 0, - x2^2 - g2*k + 1, -1, 0, k*(x1 - x2), 0, k8, 0;
       0, 0, 1/10, -1/100, 0, 0, 0, 0, 0;
       0, 0, -(5*exp(10 - 50*x2)*(g1 - 1))/(exp(10 - 50*x2) + 1)^2, 0, - 1/(10*(exp(10 - 50*x2) + 1)) - 1/20, 0, 0, 0, 0;
       -(5*exp(10 - 50*x1)*(g2 - 1))/(exp(10 - 50*x1) + 1)^2, 0, 0, 0, 0, - 1/(10*(exp(10 - 50*x1) + 1)) - 1/20, 0, 0, 0;
       (100*exp(10 - 50*x1)*(tanh(2/(exp(10 - 50*x1) + 1) + 2/(exp(10 - 50*x2) + 1) - 2)^2 - 1)*(q - 1))/(exp(10 - 50*x1) + 1)^2, 0, (100*exp(10 - 50*x2)*(tanh(2/(exp(10 - 50*x1) + 1) + 2/(exp(10 - 50*x2) + 1) - 2)^2 - 1)*(q - 1))/(exp(10 - 50*x2) + 1)^2, 0, 0, 0, - tanh(2/(exp(10 - 50*x1) + 1) + 2/(exp(10 - 50*x2) + 1) - 2) - 3, 0, 0;
       0, 0, 0, 0, 0, 0, k6, -k4, 0;
       0.5, 0, 0, 0, 0, 0, 0, 0, -1;
    ];

  dX(10:90)=Jaco*Y;